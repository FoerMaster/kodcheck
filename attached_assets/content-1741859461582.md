# [Garry's Mod Wiki](https://wiki.facepunch.com/gmod/)

[Home](https://wiki.facepunch.com/gmod/) / [http.Post](https://wiki.facepunch.com/gmod/http.Post)

- [View](https://wiki.facepunch.com/gmod/http.Post "")
- [Edit](https://wiki.facepunch.com/gmod/http.Post~edit "")
- [History](https://wiki.facepunch.com/gmod/http.Post~history "")

# http.Post

[This function is available in client, server and menu state(s)](https://wiki.facepunch.com/gmod/States "This function is available in client, server and menu state(s)")[http](https://wiki.facepunch.com/gmod/http).Post( [string](https://wiki.facepunch.com/gmod/string) url, [table](https://wiki.facepunch.com/gmod/table) parameters, [function](https://wiki.facepunch.com/gmod/function) onSuccess = nil, [function](https://wiki.facepunch.com/gmod/function) onFailure = nil, [table](https://wiki.facepunch.com/gmod/table) headers = {} )

[View Source](https://github.com/Facepunch/garrysmod/blob/master/garrysmod/lua/includes/modules/http.lua#L46-L73) [Search Github](https://github.com/Facepunch/garrysmod/search?utf8=%E2%9C%93&q=http.Post)

# Description

Sends an asynchronous **POST** request to an HTTP server. Internally calls [HTTP](https://wiki.facepunch.com/gmod/Global.HTTP).

HTTP requests returning a status code >= `400` are still considered a success and will call the [onSuccess](https://wiki.facepunch.com/gmod/Structures/HTTPRequest) callback.

The [onFailure](https://wiki.facepunch.com/gmod/Structures/HTTPRequest) callback is usually only called on DNS or TCP errors (e.g. the website is unavailable or the domain does not exist).

This cannot send or receive multiple headers with the same name.

Issue Tracker: [2232](https://github.com/Facepunch/garrysmod-issues/issues/2232)

HTTP-requests that respond with a large body may return an `unsuccessful` error. Try using the [Range](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Range) header to download the file in chunks.

HTTP-requests to destinations on private networks (such as `192.168.0.1`, or `127.0.0.1`) won't work.

To enable HTTP-requests to destinations on private networks use [Command Line Parameters](https://wiki.facepunch.com/gmod/Command_Line_Parameters) `-allowlocalhttp`. (Dedicated servers only)

# Arguments

1 [string](https://wiki.facepunch.com/gmod/string) url

The url to of the website to post.

2 [table](https://wiki.facepunch.com/gmod/table) parameters

The post parameters (x-www-form-urlencoded) to be send to the server. **Keys and values must be strings**.

3 [function](https://wiki.facepunch.com/gmod/function) onSuccess = nil

Function to be called on success.

Function argument(s):

1 [string](https://wiki.facepunch.com/gmod/string) **body** \- The reponse body as a string.

2 [string](https://wiki.facepunch.com/gmod/string) **size** \- equal to [string.len](https://wiki.facepunch.com/gmod/string.len)(body).

3 [table](https://wiki.facepunch.com/gmod/table) **headers** \- The response headers as a table.

4 [number](https://wiki.facepunch.com/gmod/number) **code** \- The HTTP success code.

4 [function](https://wiki.facepunch.com/gmod/function) onFailure = nil

Function to be called on failure.

Function argument(s):

1 [string](https://wiki.facepunch.com/gmod/string) **error** \- The error message.

5 [table](https://wiki.facepunch.com/gmod/table) headers = {}

KeyValue table for headers.

## Example

Write a file in PHP, and invoke it from Lua. The output below is written in the file, not in the console.

<?php
$p = $\_POST\["p"\];
$a = $\_POST\["a"\];

$f =fopen("write.html", "w");fwrite($f, "This is a test. $p $a\\n");fclose($f);
?>

[http](https://wiki.facepunch.com/gmod/http).[Post](https://wiki.facepunch.com/gmod/http.Post)( "http://localhost/post.php", { p ="Gmod", a ="Test"},

\-\- onSuccess functionfunction( body, length, headers, code )
[print](https://wiki.facepunch.com/gmod/Global.print)( "Done!" )
end,

\-\- onFailure functionfunction( message )
[print](https://wiki.facepunch.com/gmod/Global.print)( message )
end

)

**Output:**

This is a test. Gmod Test